# 健身平台数据库设计与实体类功能说明

## 项目架构
- **技术栈**: Spring Boot 3.0.5 + MyBatis-Plus 3.5.3.1 + Vue 3
- **架构模式**: B/S单体架构
- **数据库**: MySQL 8.0+
- **SQL文件**: `fitness_platform_complete.sql` (唯一SQL文件，包含所有表)

## 数据库表与实体类对应关系

### 1. 用户管理模块 (5张表)

#### 1.1 sys_user表 → User实体类
**功能**: 用户注册、登录、个人信息管理
```java
@TableName("sys_user")
public class User extends BaseEntity {
    private Long id;
    private String username;      // 用户名
    private String password;      // 密码(BCrypt加密)
    private String realName;      // 真实姓名
    private String phone;         // 手机号
    private String email;         // 邮箱
    private String userType;      // member|coach|admin
    // getter/setter...
}
```
**实现功能**:
- 用户注册(会员/教练)
- 用户登录认证
- 个人资料修改
- 头像上传
- 密码修改

#### 1.2 sys_role表 → Role实体类
**功能**: 角色权限管理
```java
@TableName("sys_role")
public class Role {
    private Long id;
    private String roleName;     // 角色名称
    private String roleCode;     // 角色编码
}
```

#### 1.3 sys_permission表 → Permission实体类
**功能**: 菜单权限控制
```java
@TableName("sys_permission")
public class Permission {
    private Long id;
    private Long parentId;       // 父菜单ID
    private String permissionName;
    private String permissionCode;
    private String path;         // 路由路径
}
```

### 2. 健康档案模块 (2张表)

#### 2.1 health_profile表 → HealthProfile实体类
**功能**: 健康档案管理
```java
@TableName("health_profile")
public class HealthProfile {
    private Long id;
    private Long userId;
    private BigDecimal height;    // 身高
    private BigDecimal weight;    // 体重
    private BigDecimal bmi;       // BMI指数
    private String fitnessGoal;   // 健身目标
}
```
**实现功能**:
- 创建健康档案
- BMI自动计算
- 健身目标设定
- 健康数据分析图表

#### 2.2 body_measurement表 → BodyMeasurement实体类
**功能**: 体测数据记录
```java
@TableName("body_measurement")  
public class BodyMeasurement {
    private Long id;
    private Long userId;
    private Date measureDate;     // 测量日期
    private BigDecimal weight;    // 体重
    private BigDecimal bodyFatRate; // 体脂率
}
```
**实现功能**:
- 定期体测记录
- 身体数据变化趋势图
- 进步对比分析

### 3. 课程管理模块 (4张表)

#### 3.1 course_category表 → CourseCategory实体类
**功能**: 课程分类管理
```java
@TableName("course_category")
public class CourseCategory {
    private Long id;
    private String categoryName;  // 分类名称
    private String categoryCode;  // 分类编码
}
```

#### 3.2 course表 → Course实体类
**功能**: 课程信息管理
```java
@TableName("course")
public class Course {
    private Long id;
    private String courseName;    // 课程名称
    private Long categoryId;      // 分类ID
    private Long coachId;         // 教练ID
    private BigDecimal price;     // 课程价格
    private String difficulty;    // 难度级别
}
```
**实现功能**:
- 课程发布管理
- 课程搜索过滤
- 课程详情展示
- 课程评分评价

#### 3.3 course_schedule表 → CourseSchedule实体类
**功能**: 课程排期管理
```java
@TableName("course_schedule")
public class CourseSchedule {
    private Long id;
    private Long courseId;        // 课程ID
    private Long coachId;         // 教练ID
    private Date classDate;       // 上课日期
    private Time startTime;       // 开始时间
    private Integer maxParticipants; // 最大人数
}
```
**实现功能**:
- 课程排期日历
- 课程时间安排
- 满员状态管理

#### 3.4 user_course表 → UserCourse实体类
**功能**: 用户报名管理
```java
@TableName("user_course")
public class UserCourse {
    private Long id;
    private Long userId;          // 用户ID
    private Long courseId;        // 课程ID
    private Integer status;       // 报名状态
}
```
**实现功能**:
- 在线报名
- 签到管理
- 课程评价
- 我的课程列表

### 4. 教练管理模块 (10张表)

#### 4.1 coach_info表 → CoachInfo实体类(增强版)
**功能**: 教练基本信息管理
```java
@TableName("coach_info")
public class CoachInfo {
    private Long id;
    private Long userId;              // 关联用户ID
    private String coachLevel;        // 教练等级: junior/intermediate/senior/expert
    private String speciality;        // 专长领域
    private String serviceArea;       // 服务区域
    private BigDecimal hourlyRate;    // 课时费
    private BigDecimal consultationPrice; // 咨询价格
    private String bankAccount;       // 银行账号
}
```

#### 4.2 coach_certification_apply表 → CoachCertificationApply实体类
**功能**: 教练认证申请管理
```java
@TableName("coach_certification_apply")
public class CoachCertificationApply {
    private Long id;
    private Long userId;             // 申请用户ID
    private String applyNo;          // 申请编号
    private String applyStatus;      // pending/approved/rejected/cancelled
    private String certifications;   // 证书JSON
    private String rejectReason;     // 拒绝原因
}
```
**实现功能**:
- 用户发起教练认证申请
- 上传证书照片和资质
- 管理员审核(通过/拒绝)
- 申请人撤销申请

#### 4.3 coach_resignation_apply表 → CoachResignationApply实体类
**功能**: 教练离职申请管理
```java
@TableName("coach_resignation_apply")
public class CoachResignationApply {
    private Long id;
    private Long coachId;            // 教练ID
    private String resignationType;  // resignation/revoke_qualification
    private String applyStatus;      // pending/approved/rejected/cancelled
    private Date resignationDate;    // 预计离职日期
}
```
**实现功能**:
- 教练提交离职/撤销资格申请
- 工作交接计划
- 管理员审批
- 教练取消申请

#### 4.4 coach_schedule表 → CoachSchedule实体类
**功能**: 教练日程管理
```java
@TableName("coach_schedule")
public class CoachSchedule {
    private Long id;
    private Long coachId;            // 教练ID
    private Date scheduleDate;       // 日期
    private String workStatus;       // working/leave/rest
    private String timeSlots;        // 时间段JSON
    private Integer maxBookings;     // 最大预约数
}
```
**实现功能**:
- 教练设置每日工作时间
- 管理可预约时间段
- 设置休假/休息状态
- 显示已预约情况

#### 4.5 coach_schedule_apply表 → CoachScheduleApply实体类
**功能**: 日程变更申请管理
```java
@TableName("coach_schedule_apply")
public class CoachScheduleApply {
    private Long id;
    private Long coachId;            // 教练ID
    private String applyType;        // schedule_change/leave_request
    private Date startDate;          // 开始日期
    private Date endDate;            // 结束日期
    private String applyStatus;      // pending/approved/rejected
}
```
**实现功能**:
- 教练申请修改日程
- 教练申请休假
- 管理员审批
- 影响预约通知

#### 4.6 coach_service表 → CoachService实体类
**功能**: 教练服务项目管理
```java
@TableName("coach_service")
public class CoachService {
    private Long id;
    private Long coachId;            // 教练ID
    private String serviceName;      // 服务名称
    private String serviceType;      // consultation/training/assessment
    private Integer duration;        // 服务时长
    private BigDecimal price;        // 服务价格
}
```
**实现功能**:
- 教练设置服务项目
- 定义服务类型和价格
- 设置预约规则
- 服务上下架管理

#### 4.7 coach_consultation_booking表 → CoachConsultationBooking实体类
**功能**: 教练咨询预约管理
```java
@TableName("coach_consultation_booking")
public class CoachConsultationBooking {
    private Long id;
    private String bookingNo;        // 预约编号
    private Long userId;             // 预约用户
    private Long coachId;            // 教练ID
    private Long serviceId;          // 服务项目ID
    private Date bookingDate;        // 预约日期
    private String bookingStatus;    // pending/confirmed/cancelled/completed
    private String paymentStatus;    // unpaid/paid/refunded
}
```
**实现功能**:
- 用户浏览教练日程
- 选择时间段预约
- 在线支付预约费
- 预约确认/取消
- 完成后评价

#### 4.8 coach_evaluation表 → CoachEvaluation实体类
**功能**: 教练评价管理
```java
@TableName("coach_evaluation")
public class CoachEvaluation {
    private Long id;
    private Long coachId;            // 教练ID
    private Long userId;             // 评价用户ID
    private Integer rating;          // 总体评分
    private Integer professionalRating; // 专业度评分
    private Integer attitudeRating;  // 态度评分
    private String comment;          // 评价内容
}
```
**实现功能**:
- 多维度评分系统
- 评价图片上传
- 教练回复功能
- 评价统计分析

#### 4.9 coach_income_settlement表 → CoachIncomeSettlement实体类
**功能**: 教练收入结算管理
```java
@TableName("coach_income_settlement")
public class CoachIncomeSettlement {
    private Long id;
    private String settlementNo;     // 结算单号
    private Long coachId;            // 教练ID
    private String settlementPeriod; // 结算周期
    private BigDecimal totalAmount;  // 总收入
    private BigDecimal platformFee;  // 平台服务费
    private BigDecimal actualAmount; // 实际结算金额
}
```
**实现功能**:
- 按月自动结算
- 收入明细查询
- 平台服务费计算
- 结算单导出

#### 4.10 coach_work_status表 → CoachWorkStatus实体类
**功能**: 教练工作状态统计
```java
@TableName("coach_work_status")
public class CoachWorkStatus {
    private Long id;
    private Long coachId;            // 教练ID
    private String currentStatus;    // active/leave/suspended/resigned
    private BigDecimal averageRating;// 平均评分
    private Integer totalStudents;   // 累计学员数
    private BigDecimal completionRate;// 完成率
}
```
**实现功能**:
- 实时状态跟踪
- 绩效数据统计
- 成就与警告记录
- 数据报表展示

### 5. 运动记录模块 (2张表)

#### 5.1 exercise_record表 → ExerciseRecord实体类
**功能**: 运动数据记录
```java
@TableName("exercise_record")
public class ExerciseRecord {
    private Long id;
    private Long userId;
    private Date exerciseDate;    // 运动日期
    private Integer duration;     // 运动时长(分钟)
    private BigDecimal caloriesBurned; // 消耗卡路里
}
```
**实现功能**:
- 每日运动打卡
- 运动数据统计
- 卡路里消耗计算
- 运动历史记录

#### 5.2 exercise_plan表 → ExercisePlan实体类
**功能**: 运动计划制定
```java
@TableName("exercise_plan")
public class ExercisePlan {
    private Long id;
    private Long userId;
    private String planName;      // 计划名称
    private String goal;          // 目标
    private Integer progress;     // 进度百分比
}
```

### 6. 营养管理模块 (2张表)

#### 6.1 food_database表 → Food实体类
**功能**: 食物数据库
```java
@TableName("food_database")
public class Food {
    private Long id;
    private String foodName;      // 食物名称
    private BigDecimal calories;  // 热量
    private BigDecimal protein;   // 蛋白质
}
```
**实现功能**:
- 食物营养查询
- 食物分类浏览
- 营养成分对比

#### 6.2 diet_record表 → DietRecord实体类
**功能**: 饮食记录
```java
@TableName("diet_record")
public class DietRecord {
    private Long id;
    private Long userId;
    private Date recordDate;      // 记录日期
    private String mealType;      // 餐类型
    private BigDecimal calories;  // 摄入热量
}
```
**实现功能**:
- 每日饮食记录
- 营养摄入分析
- 热量盈余计算
- 饮食建议推荐

### 7. 社交互动模块 (4张表)

#### 7.1 user_post表 → UserPost实体类
**功能**: 健身动态分享
```java
@TableName("user_post")
public class UserPost {
    private Long id;
    private Long userId;
    private String content;       // 动态内容
    private Integer likeCount;    // 点赞数
}
```
**实现功能**:
- 发布健身动态
- 图片/视频分享
- 动态点赞互动
- 健身社区交流

#### 7.2 comment表 → Comment实体类
**功能**: 评论互动
```java
@TableName("comment")
public class Comment {
    private Long id;
    private String targetType;    // 评论类型
    private Long targetId;        // 目标ID
    private String content;       // 评论内容
}
```

#### 7.3 user_like表 → UserLike实体类
**功能**: 点赞记录

#### 7.4 user_follow表 → UserFollow实体类
**功能**: 用户关注关系

### 8. 订单支付模块 (3张表)

#### 8.1 order_info表 → OrderInfo实体类
**功能**: 订单管理
```java
@TableName("order_info")
public class OrderInfo {
    private Long id;
    private String orderNo;       // 订单号
    private Long userId;
    private BigDecimal payAmount; // 支付金额
    private Integer payStatus;    // 支付状态
}
```
**实现功能**:
- 课程购买下单
- 会员卡购买
- 订单状态管理
- 订单历史查询

#### 8.2 payment_record表 → PaymentRecord实体类
**功能**: 支付记录
```java
@TableName("payment_record")  
public class PaymentRecord {
    private Long id;
    private String paymentNo;     // 支付流水号
    private String paymentMethod; // 支付方式
    private Integer paymentStatus;// 支付状态
}
```
**实现功能**:
- 微信支付集成
- 支付宝支付集成
- 支付回调处理
- 退款管理

### 9. 系统管理模块 (2张表)

#### 9.1 sys_config表 → SysConfig实体类
**功能**: 系统配置管理
```java
@TableName("sys_config")
public class SysConfig {
    private Long id;
    private String configKey;     // 配置键
    private String configValue;   // 配置值
}
```

#### 9.2 sys_log表 → SysLog实体类
**功能**: 操作日志记录
```java
@TableName("sys_log")
public class SysLog {
    private Long id;
    private Long userId;
    private String operation;     // 操作描述
    private String ip;            // IP地址
}
```

## 核心业务功能实现

### 1. 会员端功能
- **健身计划**: 制定个人健身计划，跟踪完成进度
- **课程预约**: 浏览课程、在线预约、课程签到
- **健康管理**: 记录体测数据、查看健康趋势
- **饮食记录**: 记录每日饮食、营养分析
- **社交互动**: 发布动态、关注好友、点赞评论
- **数据统计**: 运动数据统计、个人成长记录

### 2. 教练端功能
- **课程管理**: 创建课程、设置排期、管理学员
- **时间管理**: 设置可用时间、查看课程安排
- **学员管理**: 查看学员信息、课程反馈
- **收入统计**: 课时费统计、收入报表

### 3. 管理端功能
- **用户管理**: 会员管理、教练审核、权限分配
- **课程审核**: 课程内容审核、分类管理
- **数据统计**: 平台运营数据、收入统计
- **系统配置**: 参数配置、日志查看

## MyBatis-Plus使用示例

```java
// Service层示例
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> {
    
    // 用户注册
    public void register(User user) {
        user.setPassword(BCrypt.hashpw(user.getPassword()));
        user.setCreateTime(new Date());
        this.save(user);
    }
    
    // 分页查询
    public IPage<User> getUserPage(Integer pageNum, Integer pageSize) {
        Page<User> page = new Page<>(pageNum, pageSize);
        return this.page(page, new QueryWrapper<User>()
            .eq("status", 1)
            .orderByDesc("create_time"));
    }
}
```

## 前端Vue3集成示例

```javascript
// 课程列表页面
<template>
  <div class="course-list">
    <el-table :data="courseList">
      <el-table-column prop="courseName" label="课程名称" />
      <el-table-column prop="coachName" label="教练" />
      <el-table-column prop="price" label="价格" />
      <el-table-column label="操作">
        <template #default="scope">
          <el-button @click="enrollCourse(scope.row)">报名</el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { getCourseList, enrollCourse } from '@/api/course'

const courseList = ref([])

onMounted(async () => {
  const res = await getCourseList()
  courseList.value = res.data
})
</script>
```

## 部署说明

1. **执行SQL文件**
```bash
mysql -u root -p < fitness_platform_complete.sql
```

2. **配置application.yml**
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/fitness_platform
    username: root
    password: your_password
    
mybatis-plus:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.fitness.entity
```

3. **启动项目**
```bash
mvn spring-boot:run
```

---

**项目特点**:
- 单体架构，部署简单
- 功能完整，涵盖健身平台各模块
- 代码规范，易于维护扩展
- 支持移动端响应式设计