# Knife4jæ¥å£æµ‹è¯•å®Œæ•´æµç¨‹

## è®¿é—®åœ°å€

- **Adminç«¯**: `http://localhost:8080/doc.html`
- **Appç«¯**: `http://localhost:8081/doc.html`

---

## Adminç«¯æ¥å£æµ‹è¯•æµç¨‹ (ç«¯å£8080)

### ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡
1. ç¡®ä¿AdminæœåŠ¡å·²å¯åŠ¨ (ç«¯å£8080)
2. æ•°æ®åº“å·²åˆå§‹åŒ– (ä½¿ç”¨`1_fitness_platform_complete.sql`)

### ğŸ” 1. ç”¨æˆ·ç®¡ç†æ¨¡å—

#### 1.1 ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢
**åˆ†ç»„**: `ç”¨æˆ·ç®¡ç†`
**æ¥å£**: `GET /admin/user/list`

**æµ‹è¯•å‚æ•°**:
```json
{
  "page": 1,
  "size": 10,
  "username": "",
  "phone": "",
  "status": null,
  "startTime": "",
  "endTime": "",
  "sortField": "createTime",
  "sortOrder": "desc"
}
```

**é¢„æœŸç»“æœ**: è¿”å›åˆ†é¡µç”¨æˆ·åˆ—è¡¨

#### 1.2 ç”¨æˆ·è¯¦æƒ…æŸ¥è¯¢
**æ¥å£**: `GET /admin/user/detail/{userId}`

**æµ‹è¯•å‚æ•°**:
- Pathå‚æ•°: `userId = 1`

**é¢„æœŸç»“æœ**: è¿”å›IDä¸º1çš„ç”¨æˆ·è¯¦ç»†ä¿¡æ¯

#### 1.3 ç”¨æˆ·çŠ¶æ€ç®¡ç†
**æ¥å£**: `PUT /admin/user/status-form`

**æµ‹è¯•å‚æ•°**:
```
userId: 2
status: 0
remark: æµ‹è¯•ç¦ç”¨ç”¨æˆ·
```

**é¢„æœŸç»“æœ**: ç”¨æˆ·çŠ¶æ€æ›´æ–°æˆåŠŸ

### ğŸ¯ 2. è§’è‰²ç®¡ç†æ¨¡å—

#### 2.1 è§’è‰²åˆ—è¡¨æŸ¥è¯¢
**åˆ†ç»„**: `è§’è‰²ç®¡ç†`
**æ¥å£**: `GET /admin/role/list`

**æµ‹è¯•å‚æ•°**:
```json
{
  "page": 1,
  "size": 10,
  "roleName": "",
  "roleCode": "",
  "status": null,
  "startTime": "",
  "endTime": "",
  "sortField": "createTime",
  "sortOrder": "desc"
}
```

**é¢„æœŸç»“æœ**: è¿”å›åˆ†é¡µè§’è‰²åˆ—è¡¨

#### 2.2 è·å–å¯ç”¨è§’è‰²åˆ—è¡¨
**æ¥å£**: `GET /admin/role/available`

**æµ‹è¯•å‚æ•°**: æ— 

**é¢„æœŸç»“æœ**: è¿”å›æ‰€æœ‰å¯ç”¨çŠ¶æ€çš„è§’è‰²

#### 2.3 è§’è‰²ç»Ÿè®¡ä¿¡æ¯
**æ¥å£**: `GET /admin/role/statistics`

**æµ‹è¯•å‚æ•°**: æ— 

**é¢„æœŸç»“æœ**: è¿”å›è§’è‰²ç›¸å…³ç»Ÿè®¡æ•°æ®

### ğŸ‘¥ 3. ç”¨æˆ·è§’è‰²ç®¡ç†

#### 3.1 ç”¨æˆ·è§’è‰²åˆ†é… (JSONæ ¼å¼)
**åˆ†ç»„**: `ç”¨æˆ·è§’è‰²ç®¡ç†`
**æ¥å£**: `POST /admin/user-role/assign`

**æµ‹è¯•å‚æ•°**:
```json
{
  "userId": 1,
  "roleIds": [2, 3]
}
```

**é¢„æœŸç»“æœ**: ç”¨æˆ·è§’è‰²åˆ†é…æˆåŠŸ

#### 3.2 ç”¨æˆ·è§’è‰²åˆ†é… (è¡¨å•æ ¼å¼)
**æ¥å£**: `POST /admin/user-role/assign-form`

**æµ‹è¯•å‚æ•°**:
```
userId: 1
roleIds: 2,3
```

**é¢„æœŸç»“æœ**: ç”¨æˆ·è§’è‰²åˆ†é…æˆåŠŸ

#### 3.3 æ‰¹é‡è§’è‰²åˆ†é…
**æ¥å£**: `POST /admin/user-role/batch-assign`

**æµ‹è¯•å‚æ•°**:
```json
{
  "userIds": [1, 2, 3],
  "roleIds": [2]
}
```

**é¢„æœŸç»“æœ**: æ‰¹é‡è§’è‰²åˆ†é…æˆåŠŸ

---

## Appç«¯æ¥å£æµ‹è¯•æµç¨‹ (ç«¯å£8081)

### ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡
1. ç¡®ä¿AppæœåŠ¡å·²å¯åŠ¨ (ç«¯å£8081)
2. æ•°æ®åº“å·²åˆå§‹åŒ–

### ğŸ” 1. ç”¨æˆ·è®¤è¯æ¨¡å—

#### 1.1 å‘é€çŸ­ä¿¡éªŒè¯ç 
**åˆ†ç»„**: `01-ç”¨æˆ·è®¤è¯`
**æ¥å£**: `POST /app/auth/sms-code/send`

**æµ‹è¯•å‚æ•°**:
```json
{
  "phone": "13888888888",
  "type": "register",
  "captcha": "abcd",
  "captchaKey": "captcha_key_123"
}
```

**é¢„æœŸç»“æœ**: éªŒè¯ç å‘é€æˆåŠŸï¼Œæ§åˆ¶å°æ˜¾ç¤ºéªŒè¯ç 123456

#### 1.2 ç”¨æˆ·æ³¨å†Œ
**æ¥å£**: `POST /app/auth/register`

**æµ‹è¯•å‚æ•°** (æ³¨å†Œå‰éœ€å…ˆå‘é€éªŒè¯ç ):
```json
{
  "username": "testuser001",
  "phone": "13888888888",
  "password": "123456",
  "confirmPassword": "123456",
  "smsCode": "123456",
  "nickname": "æµ‹è¯•ç”¨æˆ·001",
  "email": "testuser001@example.com",
  "gender": 1,
  "birthDate": "1990-01-01",
  "inviteCode": ""
}
```

**é¢„æœŸç»“æœ**: ç”¨æˆ·æ³¨å†ŒæˆåŠŸ

#### 1.3 å¯†ç ç™»å½•
**æ¥å£**: `POST /app/auth/login`

**æµ‹è¯•å‚æ•°**:
```json
{
  "account": "testuser001",
  "password": "123456",
  "loginType": "password",
  "deviceId": "device_test_001",
  "deviceType": "web"
}
```

**é¢„æœŸç»“æœ**: ç™»å½•æˆåŠŸï¼Œè¿”å›JWT token

#### 1.4 çŸ­ä¿¡éªŒè¯ç ç™»å½•
**æ­¥éª¤1**: å…ˆå‘é€ç™»å½•éªŒè¯ç 
```json
{
  "phone": "13888888888",
  "type": "login",
  "captcha": "abcd",
  "captchaKey": "captcha_key_123"
}
```

**æ­¥éª¤2**: çŸ­ä¿¡ç™»å½•ï¼ˆä½¿ç”¨è™šæ‹Ÿå¯†ç ç»•è¿‡éªŒè¯ï¼‰
```json
{
  "account": "13888888888",
  "password": "dummy_password",
  "loginType": "sms",
  "smsCode": "123456"
}
```

**æ³¨æ„**: ç”±äºDTOéªŒè¯é—®é¢˜ï¼ŒçŸ­ä¿¡ç™»å½•æ—¶éœ€è¦æä¾›ä¸€ä¸ªè™šæ‹Ÿå¯†ç ç»•è¿‡éªŒè¯ï¼Œä½†ä¸šåŠ¡é€»è¾‘ä¸­åªä¼šéªŒè¯çŸ­ä¿¡éªŒè¯ç ã€‚

**é¢„æœŸç»“æœ**: ç™»å½•æˆåŠŸï¼Œè¿”å›JWT token

#### 1.5 åˆ·æ–°ä»¤ç‰Œ
**æ¥å£**: `POST /app/auth/refresh-token`

**æµ‹è¯•å‚æ•°** (ä½¿ç”¨ç™»å½•è¿”å›çš„refresh token):
```json
{
  "refreshToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
}
```

**é¢„æœŸç»“æœ**: è¿”å›æ–°çš„access token

#### 1.6 å¿˜è®°å¯†ç 
**æ­¥éª¤1**: å‘é€é‡ç½®å¯†ç éªŒè¯ç 
```json
{
  "phone": "13888888888",
  "type": "reset_password",
  "captcha": "abcd",
  "captchaKey": "captcha_key_123"
}
```

**æ­¥éª¤2**: é‡ç½®å¯†ç 
**æ¥å£**: `POST /app/auth/forget-password`
```json
{
  "phone": "13888888888",
  "smsCode": "123456",
  "newPassword": "newpass123",
  "confirmPassword": "newpass123"
}
```

**é¢„æœŸç»“æœ**: å¯†ç é‡ç½®æˆåŠŸ

#### 1.7 é€€å‡ºç™»å½•
**æ¥å£**: `POST /app/auth/logout`

**Headers**: 
```
Authorization: Bearer {åˆšæ‰ç™»å½•è·å¾—çš„token}
```

**æµ‹è¯•å‚æ•°**: æ— 

**é¢„æœŸç»“æœ**: é€€å‡ºç™»å½•æˆåŠŸ

### ğŸ‘¤ 2. ä¸ªäººä¿¡æ¯ç®¡ç†æ¨¡å—

#### 2.1 è·å–ä¸ªäººä¿¡æ¯
**åˆ†ç»„**: `02-ä¸ªäººä¿¡æ¯ç®¡ç†`
**æ¥å£**: `GET /app/profile/info`

**Headers** (æ‰€æœ‰ä¸ªäººä¿¡æ¯æ¥å£éƒ½éœ€è¦):
```
Authorization: Bearer {ç™»å½•token}
```

**æµ‹è¯•å‚æ•°**: æ— 

**é¢„æœŸç»“æœ**: è¿”å›å½“å‰ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯

#### 2.2 æ›´æ–°ä¸ªäººä¿¡æ¯
**æ¥å£**: `PUT /app/profile/update`

**æµ‹è¯•å‚æ•°**:
```json
{
  "nickname": "æ›´æ–°åçš„æ˜µç§°",
  "avatar": "http://example.com/avatar.jpg",
  "gender": 1,
  "birthday": "1990-01-01",
  "height": 175.5,
  "weight": 70.0,
  "introduction": "è¿™æ˜¯ä¸ªäººç®€ä»‹"
}
```

**é¢„æœŸç»“æœ**: ä¸ªäººä¿¡æ¯æ›´æ–°æˆåŠŸ

#### 2.3 ä¿®æ”¹å¯†ç 
**æ¥å£**: `PUT /app/profile/change-password`

**æµ‹è¯•å‚æ•°**:
```json
{
  "oldPassword": "123456",
  "newPassword": "newpass123",
  "confirmPassword": "newpass123"
}
```

**é¢„æœŸç»“æœ**: å¯†ç ä¿®æ”¹æˆåŠŸ

#### 2.4 ç»‘å®šæ‰‹æœºå·
**æ­¥éª¤1**: å‘é€éªŒè¯ç  (ä½¿ç”¨è®¤è¯æ¨¡å—çš„æ¥å£)
**æ­¥éª¤2**: ç»‘å®šæ‰‹æœºå·

**æ¥å£**: `PUT /app/profile/bind-phone`
```json
{
  "phone": "13900139001",
  "smsCode": "123456"
}
```

**é¢„æœŸç»“æœ**: æ‰‹æœºå·ç»‘å®šæˆåŠŸ

### ğŸ¯ 3. è§’è‰²ç®¡ç†æ¨¡å— (Appç«¯)

#### 3.1 è§’è‰²åˆ—è¡¨æŸ¥è¯¢
**åˆ†ç»„**: `12-è§’è‰²ç®¡ç†`
**æ¥å£**: `GET /app/role/list`

**æµ‹è¯•å‚æ•°**:
```json
{
  "page": 1,
  "size": 10,
  "roleName": "",
  "roleCode": "",
  "status": null,
  "startTime": "",
  "endTime": "",
  "sortOrder": "desc"
}
```

**é¢„æœŸç»“æœ**: è¿”å›åˆ†é¡µè§’è‰²åˆ—è¡¨

#### 3.2 è·å–å¯ç”¨è§’è‰²åˆ—è¡¨
**æ¥å£**: `GET /app/role/available`

**æµ‹è¯•å‚æ•°**: æ— 

**é¢„æœŸç»“æœ**: è¿”å›æ‰€æœ‰å¯ç”¨çŠ¶æ€çš„è§’è‰²

---

## ğŸ“‹ å®Œæ•´æµ‹è¯•é¡ºåºå»ºè®®

### Adminç«¯æµ‹è¯•é¡ºåº:
1. è§’è‰²ç®¡ç† â†’ è§’è‰²åˆ—è¡¨æŸ¥è¯¢
2. è§’è‰²ç®¡ç† â†’ è·å–å¯ç”¨è§’è‰²
3. ç”¨æˆ·ç®¡ç† â†’ ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢
4. ç”¨æˆ·è§’è‰²ç®¡ç† â†’ ç”¨æˆ·è§’è‰²åˆ†é…
5. ç”¨æˆ·ç®¡ç† â†’ ç”¨æˆ·çŠ¶æ€ç®¡ç†

### Appç«¯æµ‹è¯•é¡ºåº:
1. **è®¤è¯æµç¨‹**:
   - å‘é€æ³¨å†ŒéªŒè¯ç  â†’ ç”¨æˆ·æ³¨å†Œ â†’ å¯†ç ç™»å½•
2. **ä¸ªäººä¿¡æ¯ç®¡ç†**:
   - è·å–ä¸ªäººä¿¡æ¯ â†’ æ›´æ–°ä¸ªäººä¿¡æ¯ â†’ ä¿®æ”¹å¯†ç 
3. **å…¶ä»–åŠŸèƒ½**:
   - è§’è‰²åˆ—è¡¨æŸ¥è¯¢ â†’ é€€å‡ºç™»å½•

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. éªŒè¯ç é¢‘ç‡é™åˆ¶
- åŒä¸€æ‰‹æœºå·10ç§’å†…åªèƒ½å‘é€ä¸€æ¬¡éªŒè¯ç 
- å¦‚æœæç¤ºé¢‘ç‡é™åˆ¶ï¼Œç­‰å¾…10ç§’åé‡è¯•

### 2. å‚æ•°æ ¼å¼è¦æ±‚
- æ‰€æœ‰æšä¸¾å€¼éƒ½æ˜¯**å°å†™** (password, sms, register, loginç­‰)
- JSONæ ¼å¼è¦æ­£ç¡®ï¼Œæ³¨æ„åŒå¼•å·

### 3. æƒé™éªŒè¯
- ä¸ªäººä¿¡æ¯ç›¸å…³æ¥å£éœ€è¦Bearer token
- tokenä»ç™»å½•æ¥å£è·å–

### 4. æ•°æ®åº“çŠ¶æ€
- æµ‹è¯•å‰ç¡®ä¿æ•°æ®åº“æœ‰åˆå§‹æ•°æ®
- å¦‚æœç”¨æˆ·å·²å­˜åœ¨ï¼Œæ³¨å†Œä¼šå¤±è´¥

### 5. å¼€å‘æ¨¡å¼
- çŸ­ä¿¡éªŒè¯ç å›ºå®šä¸º123456
- ä¸ä¼šçœŸå®å‘é€çŸ­ä¿¡

## ğŸ” é”™è¯¯æ’æŸ¥

### å¸¸è§é”™è¯¯:
1. **400 å‚æ•°éªŒè¯å¤±è´¥**: æ£€æŸ¥å‚æ•°æ ¼å¼å’Œå¿…å¡«å­—æ®µ
2. **éªŒè¯ç é”™è¯¯**: ç¡®ä¿ä½¿ç”¨123456ï¼Œæ³¨æ„éªŒè¯ç ç±»å‹åŒ¹é…
3. **ç”¨æˆ·å·²å­˜åœ¨**: æ›´æ¢usernameæˆ–phone
4. **tokenæ— æ•ˆ**: é‡æ–°ç™»å½•è·å–æ–°token

### æµ‹è¯•æŠ€å·§:
1. å…ˆç”¨Knife4jæä¾›çš„é»˜è®¤ç¤ºä¾‹æµ‹è¯•
2. æˆåŠŸåå†ä¿®æ”¹ä¸ºè‡ªå®šä¹‰å‚æ•°
3. æŒ‰ç…§å»ºè®®çš„æµ‹è¯•é¡ºåºè¿›è¡Œ
4. ä¿å­˜æˆåŠŸçš„tokenç”¨äºåç»­æ¥å£æµ‹è¯•